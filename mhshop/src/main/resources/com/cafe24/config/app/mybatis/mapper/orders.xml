<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="orders">

	<!-- 주문리스트 -->
	<select id="selectList" resultType="ordersvo">
		select orders_no as ordersNo, reg_date as regDate, status, bank_name as bankName, bank_num as bankNum, pay_date as payDate, money, tracking_num as trackingNum,

		cast(AES_DECRYPT(to_name, #{aesKey}) as char) as toName,
		cast(AES_DECRYPT(to_phone, #{aesKey}) as char) as toPhone,
		cast(AES_DECRYPT(to_zipcode, #{aesKey}) as char) as toZipcode,
		cast(AES_DECRYPT(to_addr, #{aesKey}) as char) as toAddr,
		cast(AES_DECRYPT(member_id, #{aesKey}) as char) as memberId
		
		from orders order by orders_no desc
	</select>
	
	
	
	
	<!-- 테스트 -->
	
	
	<!-- 테스트 insert -->
	<insert id="test_insert" parameterType="ordersvo">
	<![CDATA[
		insert into orders(orders_no, reg_date, status, bank_name, bank_num, money, tracking_num, to_name, to_phone, to_zipcode, to_addr, member_id)
		values(#{ordersNo}, now(), #{status}, #{bankName}, #{bankNum}, #{money}, #{trackingNum},
		AES_ENCRYPT(#{toName}, #{aesKey}),
		AES_ENCRYPT(#{toPhone}, #{aesKey}),
		AES_ENCRYPT(#{toZipcode}, #{aesKey}),
		AES_ENCRYPT(#{toAddr}, #{aesKey}),
		AES_ENCRYPT(#{memberId}, #{aesKey}))
	]]>
	</insert>
	
	<!-- 테스트 deleteall -->
	<delete id="test_deleteall">
		delete from orders
	</delete>
	
</mapper>
